<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title><%KULT NAME%>: QuotesKult</title>
    <script defer src="/__/firebase/9.6.10/firebase-app-compat.js"></script>
    <script defer src="/__/firebase/9.6.10/firebase-auth-compat.js"></script>
    <script defer src="/__/firebase/9.6.10/firebase-firestore-compat.js"></script>
    <script defer src="/__/firebase/9.6.10/firebase-analytics-compat.js"></script>
    <script defer src="/__/firebase/init.js?useEmulator=true"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.13.1/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/ui/1.13.1/jquery-ui.js"></script>
    <script type="module">
      // Import the functions you need from the SDKs you need
      import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js";
      import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-analytics.js";
      import { getAuth, signInWithPopup, GoogleAuthProvider } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-auth.js";
      // TODO: Add SDKs for Firebase products that you want to use
      // https://firebase.google.com/docs/web/setup#available-libraries
      // Your web app's Firebase configuration
      // For Firebase JS SDK v7.20.0 and later, measurementId is optional
      const firebaseConfig = {
        apiKey: "AIzaSyCtskCd6Ptv-JFSjAXnUvkhTJ5Mkc3gDiU",
        authDomain: "quoteskult.firebaseapp.com",
        projectId: "quoteskult",
        storageBucket: "quoteskult.appspot.com",
        messagingSenderId: "542338192081",
        appId: "1:542338192081:web:1b9827d934ef402627abf0",
        measurementId: "G-HBQK00MFBG"
      };
    
      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const analytics = getAnalytics(app);
      const auth = getAuth();
      signInWithPopup(auth, provider)
        .then((result) => {
          // This gives you a Google Access Token. You can use it to access the Google API.
          const credential = GoogleAuthProvider.credentialFromResult(result);
          const token = credential.accessToken;
          // The signed-in user info.
          const user = result.user;
          // ...
        }).catch((error) => {
          // Handle Errors here.
          const errorCode = error.code;
          const errorMessage = error.message;
          // The email of the user's account used.
          const email = error.email;
          // The AuthCredential type that was used.
          const credential = GoogleAuthProvider.credentialFromError(error);
          // ...
        });
    </script>
    <!-- OLD QUOTE ADD DIALOG <script>
        $( function() {
          var dialog, form,
      
            // From http://www.whatwg.org/specs/web-apps/current-work/multipage/states-of-the-type-attribute.html#e-mail-state-%28type=email%29
            Lquote = $( "#Lquote" ),
            Lquotee = $( "#Lquotee" ),
            password = $( "#password" ),
            allFields = $( [] ).add( Lquote ).add( Lquotee );
      
          function addQuote() {
            allFields.removeClass( "ui-state-error" );
            writeQuota(Lquote.val(), Lquotee.val())
            if ( true ) {
              
              dialog.dialog( "close" );
            }
            return true;
          }
      
          dialog = $( "#dialog-form" ).dialog({
            autoOpen: false,
            height: 290,
            width: 350,
            modal: true,
            buttons: {
              "AddQuote": addQuote,
              Cancel: function() {
                dialog.dialog( "close" );
              }
            },
            close: function() {
              form[ 0 ].reset();
              allFields.removeClass( "ui-state-error" );
            }
          });
      
          form = dialog.find( "form" ).on( "submit", function( event ) {
            event.preventDefault();
            addQuote();
          });
      
          $( "#create-quote" ).button().on( "click", function() {
            dialog.dialog( "open" );
          });
        } );
    </script>-->
    <!-- INSPIROBOT IMAGE GETTER<script>
      function setImage(image){
        var string;
        $.get("https://inspirobot.me/api?generate=true",
        {},
        function(data){
          image.attr('src',data)
        });
      }
    </script> -->
     <!-- OLD CARD GENERATOR<script>
       
      var html, rowtml
      var hasSetTemplate = false;
      var i = 0;
      function generateQuotes(data){
        if(!hasSetTemplate){
          html = $('#template').html();
          rowtml = $("#row").html();
          $('#template').remove();
          hasSetTemplate = !hasSetTemplate
        }
        $('#Quotes').empty();
        var quoteIdList = [];
        for(entry in data){
          if(entry != "Messages"){
            quoteIdList.push(entry)
          }
        }
        if(quoteIdList.length != 0){
          displayQuotes(quoteIdList)
        }
        
      }
      function displayQuotes(data){
        console.log(data)
        console.log(i)
        firebase.database().ref().child(data.pop()).get().then((snapshot)=>{
          if(i==0){
            $('#Quotes').append(html);
            setImage($("#image"))
            $("#image").attr('id','')
            $("#quotb").text(snapshot.val().quote)
            $("#name").text(snapshot.val().quotee)
            //$("#quotb").attr('style','text-shadow: 1px 1px 0 #444; font-size: 25px')
            $("#quotb").attr('id','')
            $("#name").attr('id','')
          }else{
            $("#row").append(rowtml)
            setImage($("#image"))
            $("#image").attr('id','')
            $("#quotb").text(snapshot.val().quote)
            $("#name").text(snapshot.val().quotee)
            //$("#quotb").attr('style','text-shadow: 1px 1px 0 #444; font-size: 25px')
            $("#quotb").attr('id','')
            $("#name").attr('id','')
          }
          i++
          if(i==3){
            $("#row").attr('id','')
            i=0
          }
          if(data.length != 0){
            displayQuotes(data)
          }
        })
      }
    </script> -->
    <script>
      //Code to copy the quote to clipboard
      function copyQuote(item){
        $(item).find(".tooltiptext").text("\""+$(item).find(".quote").text()+"\" Copied to clipboard")
        console.log($(item).attr('id'))
        navigator.clipboard.writeText($(item).find(".quote").text());
      }
      //Clears the tooltip text
      function resetCopyTooltip(item){
        $(item).find(".tooltiptext").text("Click to Copy Quote")
      }
    </script>
    <style>
      body,h1,h2,h3,h4,h5,h6 {font-family: "Raleway", sans-serif}
      .hovergrey:hover{
        color: rgb(80, 80, 80);
      }
      .tooltip {
        position: relative;
      }
      /* Tooltip text */
      .tooltip .tooltiptext {
        visibility: hidden;
        width: 140px;
        background-color: #555;
        color: #fff;
        text-align: center;
        border-radius: 6px;
        padding: 5px;
        position: absolute;
        z-index: 1;
        bottom: 100%;
        left: 50%;
        margin-left: -75px;
        opacity: 0;
        transition: opacity 0.3s;
      }

      .tooltip .tooltiptext::after {
        content: "";
        position: absolute;
        top: 100%;
        left: 50%;
        margin-left: -5px;
        border-width: 5px;
        border-style: solid;
        border-color: #555 transparent transparent transparent;
      }

      .tooltip:hover .tooltiptext {
        visibility: visible;
        opacity: 1;
      }
    </style>
    <div id="dialog-form" title="Add New Quote">
      <form>
        <fieldset>
          <label for="Lquote">Quote</label>
          <input type="text" name="Lquote" id="Lquote" value="" class="text ui-widget-content ui-corner-all"style="display:block; margin-bottom:12px; width:95%; padding: .4em;" autocomplete="off">
          <label for="Lquotee">Quotee</label>
          <input type="text" name="Lquotee" id="Lquotee" value="" class="text ui-widget-content ui-corner-all" style="display:block; margin-bottom:12px; width:95%; padding: .4em;"autocomplete="off">     
          <!-- Allow form submission with keyboard without duplicating the dialog button -->
          <input type="submit" tabindex="-1" style="position:absolute; top:-1000px">
        </fieldset>
      </form>
    </div>
    <div id="login-form" title="Login:">
      <form>
        <fieldset>
          <!-- Allow form submission with keyboard without duplicating the dialog button -->
          <input type="submit" tabindex="-1" style="position:absolute; top:-1000px">
        </fieldset>
      </form>
    </div>
  </head>
  <body>
    <body class="w3-light-grey w3-content" style="max-width:1600px">
      
      <!-- !PAGE CONTENT! -->
      <div class="w3-main" style="margin-left:0px">
      
        <!-- Header -->
        <header id="portfolio">
          <div class="w3-container">
            <h1 style="display:inline;""><b>Quotes From: <%KULT NAME%></b></h1>
            <!--<button id="create-quote" class="w3-button w3-border-black w3-topbar w3-bottombar w3-leftbar w3-rightbar">AddQuote</button>-->
            <div class="w3-right" style="margin-top: 10px;">
            <button id="change-kult" class="w3-button w3-border-black w3-topbar w3-bottombar w3-leftbar w3-rightbar w3-round-xxlarge">Change Kult</button>
            <button id="login" class="w3-button w3-border-black w3-topbar w3-bottombar w3-leftbar w3-rightbar w3-round-xxlarge">Login</button>
            </div>
            <div class="w3-section w3-bottombar"></div>
          </div>
        </header>
        <div class="w3-padding-16"></div>
        
        <div id="template">
          <div>
            <div class="w3-row-padding" id="row">
              <div class="w3-third w3-container w3-margin-bottom" id="box">
                <!--<img id="image"src="a.png" alt="Norway" style="width:100%" class="">-->
                <div  id="copyQuote" class="w3-container w3-white tooltip"onclick="copyQuote(this)" onmouseout="resetCopyTooltip(this)">
                    <p><b class="hovergrey quote"id="quotb" style="text-shadow: 1px 1px 0 #444; font-size: 25px"">QUOTE</b></p>
                    <span class="tooltiptext">Click to copy quote</span>
                    <p id="name">NAME</p>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- First Photo Grid-->
        <div id="Quotes">
          
        </div>
        <div class="w3-black w3-center w3-padding-16"></div>
        <div class="w3-black w3-center">Powered by <a href="https://www.w3schools.com/w3css/default.asp" title="W3.CSS" target="_blank" class="w3-hover-opacity">w3.css</a></div>
        <div class="w3-black w3-center" id="load">Firebase SDK Loading...</div>
        <div class="w3-black w3-center w3-padding-16"></div>
      
      <!-- End page content -->
      </div>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        const loadEl = document.querySelector('#load');
        // // 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥
        // // The Firebase SDK is initialized and available here!
        //
        // firebase.auth().onAuthStateChanged(user => { });
        //firebase.database().ref().get().then((snapshot) => { 
        //  generateQuotes(snapshot.val())
        //});
        // firebase.firestore().doc('/foo/bar').get().then(() => { });
        // firebase.functions().httpsCallable('yourFunction')().then(() => { });
        // firebase.messaging().requestPermission().then(() => { });
        // firebase.storage().ref('/path/to/ref').getDownloadURL().then(() => { });
         firebase.analytics(); // call to activate
         //firebase.analytics().logEvent('tutorial_completed');
        // firebase.performance(); // call to activate
        //
        // // 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥

        try {
          let app = firebase.app();
          let features = [
            'auth', 
            'database', 
            'firestore',
            'functions',
            'messaging', 
            'storage', 
            'analytics', 
            'remoteConfig',
            'performance',
          ].filter(feature => typeof app[feature] === 'function');
          loadEl.textContent = `Firebase SDK loaded with ${features.join(', ')}`;
        } catch (e) {
          console.error(e);
          loadEl.textContent = 'Error loading the Firebase SDK, check the console.';
        }
      });
    </script>
  </body>
</html>
